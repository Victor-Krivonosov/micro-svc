# Пример микросервисного приложения

В данном репозитории собрано приложение из 5 микросервисов на самых популярных языка программирования (GO, NodeJS, Java, Python), для всех сервисов написаны докерфайлы и по 2 сценария деплоя - локальный в композе и в Kubernetes.

Приложение представляет из себя простой список дел (to-do лист), но при этом сделано для демонстрации работы инструмента трассировки запросов в микросервисных приложениях (zipkin)

# Компоненты

1. Front часть - это приложение на Javascript, предоставляющее пользовательский интерфейс. Создано с помощью VueJS.
2. Auth-api написан на Go и предоставляет функцию авторизации. Генерирует токены JWT для использования с другими API.
3. Todos-api написан с помощью NodeJS, предоставляет функциональность CRUD для пользовательских записей todo. Кроме того, он регистрирует операции "создать" и "удалить" в очереди Redis, чтобы позже они могли быть обработаны с помощью Log-message-processor.
4. Users-api - это проект Spring Boot, написанный на Java. Предоставляет профили пользователей.
5. Log-message-processor - это процессор с короткой очередью, написанный на Python. Его единственная цель - считывать сообщения из очереди Redis и выводить их в стандартный вывод.
6. Zipkin -  дополнительная сторонняя система, которая объединяет трассировки, созданные другими компонентами.

Ниже приведена схема взаимодействия микросервисов
![microservice-app-example](https://user-images.githubusercontent.com/1905821/34918427-a931d84e-f952-11e7-85a0-ace34a2e8edb.png)

# Варианты деплоя:
1. Docker compose
    Заходим в папку с сервисом.
    Собираем через docker build -f Dockerfile . -t ИМЯ СЕРВИСА
    Запускаем сначала front, запускаем docker compose up -d
    Вместе с front запускается zipkin и redis
    Запускаем остальные сервисы, также через docker compose 
    Проверяем, что открывается front на 8080, логинимся admin/admin, и все кнопки нажимаются
    Проверяем с zipkin порт 9411
    
2. Kubectl
    Запускаем инфру через docker compose up -d  (zipkin и redis)
    Заходим в папки k8s внутри сервисах, и делаем kubectl create -f .
    Проверяем, что все установилось верно, заходим на NodePort front 
    Проверяем что открывается front, логинимся admin/admin, и все кнопки нажимаются
    Проверяем с zipkin порт 9411
   
4. Helm
    Запускаем инфру через docker compose up -d  (zipkin и redis)
    Заходим в папку helm в каждом сервисе, и делаем helm install ИМЯ-СЕРВИСА .
    Проверяем, что все установилось верно, заходим на NodePort front 
    Проверяем что открывается front, логинимся admin/admin, и все кнопки нажимаются
    Проверяем с zipkin порт 9411
